import{a as p}from"./chunk-KPDYTURW.js";import{$a as B,Cb as Q,Da as w,Db as X,Ea as R,Ga as k,Ha as G,Za as T,ab as V,bb as q,cb as H,l as S,m as a,n as F,o as E,s as A,u as I,vb as U,w as L,wb as W,x as y,xb as J,z as D,zb as K}from"./chunk-UMM7N7DW.js";import{Ic as _,Ka as v,Mb as M,Oa as i,Ta as O,Ua as s,Uc as N,Z as x,Zc as l,_ as c,aa as h,ad as b,bb as C,ke as j,pb as n,qb as r,rb as g,yb as P}from"./chunk-COQ5IRDM.js";import"./chunk-GAL4ENT6.js";var u=class e{constructor(t,o,m,Z){this.fb=t;this.authService=o;this.router=m;this.message=Z}loginForm;isLoading=!1;ngOnInit(){if(this.authService.isLoggedIn()){this.router.navigate(["/dashboard"]);return}this.loginForm=this.fb.group({email:["",[a.required,a.email]],password:["",[a.required,a.minLength(6)]]})}onSubmit(){this.loginForm.valid?(this.isLoading=!0,this.authService.login(this.loginForm.value).subscribe({next:t=>{t.meta.error?this.message.error(t.meta.message||"\u0110\u0103ng nh\u1EADp th\u1EA5t b\u1EA1i"):(this.authService.getMe().subscribe({next:o=>{console.log("User info:",o)},error:o=>{console.error("Error fetching user info:",o),this.message.error(o.error.data??"L\u1ED7i khi t\u1EA3i th\xF4ng tin ng\u01B0\u1EDDi d\xF9ng")}}),this.message.success("\u0110\u0103ng nh\u1EADp th\xE0nh c\xF4ng"),this.router.navigate(["/dashboard"]))},error:t=>{console.error("Login error:",t),this.message.error(t.error.data??"\u0110\u0103ng nh\u1EADp th\u1EA5t b\u1EA1i. Vui l\xF2ng th\u1EED l\u1EA1i sau."),this.isLoading=!1},complete:()=>{this.isLoading=!1}})):Object.values(this.loginForm.controls).forEach(t=>{t.invalid&&t.markAsTouched()})}static \u0275fac=function(o){return new(o||e)(i(y),i(p),i(l),i(X))};static \u0275cmp=O({type:e,selectors:[["app-login"]],standalone:!1,decls:17,vars:2,consts:[[1,"login-container"],[1,"login-box"],[1,"login-header"],["src","/assets/photos/logo-landscape-1.png","alt","Logo","onerror","this.src='assets/images/default_property.jpeg'",1,"logo"],["nz-form","",1,"login-form",3,"ngSubmit","formGroup"],["nzErrorTip","Vui l\xF2ng nh\u1EADp email h\u1EE3p l\u1EC7!"],["nzPrefixIcon","user"],["type","email","nz-input","","formControlName","email","placeholder","Email"],["nzErrorTip","M\u1EADt kh\u1EA9u ph\u1EA3i c\xF3 \xEDt nh\u1EA5t 6 k\xFD t\u1EF1!"],["nzPrefixIcon","lock"],["type","password","nz-input","","formControlName","password","placeholder","M\u1EADt kh\u1EA9u"],["nz-button","","nzType","primary",1,"login-form-button",3,"nzLoading"]],template:function(o,m){o&1&&(n(0,"div",0)(1,"div",1)(2,"div",2),g(3,"img",3),n(4,"h1"),M(5,"\u0110\u0103ng nh\u1EADp"),r()(),n(6,"form",4),P("ngSubmit",function(){return m.onSubmit()}),n(7,"nz-form-item")(8,"nz-form-control",5)(9,"nz-input-group",6),g(10,"input",7),r()()(),n(11,"nz-form-item")(12,"nz-form-control",8)(13,"nz-input-group",9),g(14,"input",10),r()()(),n(15,"button",11),M(16," \u0110\u0103ng nh\u1EADp "),r()()()()),o&2&&(v(6),C("formGroup",m.loginForm),v(9),C("nzLoading",m.isLoading))},dependencies:[A,S,F,E,I,L,H,q,W,U,J,T,B,k,w,R],styles:[".login-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;min-height:100vh;background-color:#f0f2f5;padding:20px}.login-container[_ngcontent-%COMP%]   .login-box[_ngcontent-%COMP%]{width:100%;max-width:400px;padding:40px;background:#fff;border-radius:8px;box-shadow:0 2px 8px #0000001a}.login-container[_ngcontent-%COMP%]   .login-box[_ngcontent-%COMP%]   .login-header[_ngcontent-%COMP%]{text-align:center;margin-bottom:40px}.login-container[_ngcontent-%COMP%]   .login-box[_ngcontent-%COMP%]   .login-header[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]{width:200px;margin-bottom:24px}.login-container[_ngcontent-%COMP%]   .login-box[_ngcontent-%COMP%]   .login-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:24px;color:#003c74;margin:0}.login-container[_ngcontent-%COMP%]   .login-box[_ngcontent-%COMP%]   .login-form[_ngcontent-%COMP%]   .login-form-button[_ngcontent-%COMP%]{width:100%;height:40px;font-size:16px;background-color:#003c74;border-color:#003c74}.login-container[_ngcontent-%COMP%]   .login-box[_ngcontent-%COMP%]   .login-form[_ngcontent-%COMP%]   .login-form-button[_ngcontent-%COMP%]:hover{background-color:#002241;border-color:#002241}.login-container[_ngcontent-%COMP%]   .login-box[_ngcontent-%COMP%]   .login-form[_ngcontent-%COMP%]   nz-form-item[_ngcontent-%COMP%]{margin-bottom:24px}.login-container[_ngcontent-%COMP%]   .login-box[_ngcontent-%COMP%]   .login-form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{height:40px}"]})};var f=class e{constructor(t,o){this.authService=t;this.router=o}canActivate(){return this.authService.isLoggedIn()?(this.router.navigate(["/dashboard"]),!1):!0}static \u0275fac=function(o){return new(o||e)(h(p),h(l))};static \u0275prov=x({token:e,factory:e.\u0275fac,providedIn:"root"})};var to=[{path:"login",component:u,canActivate:[f]}],d=class e{static \u0275fac=function(o){return new(o||e)};static \u0275mod=s({type:e});static \u0275inj=c({imports:[b.forChild(to),b]})};var Y=class e{static \u0275fac=function(o){return new(o||e)};static \u0275mod=s({type:e});static \u0275inj=c({imports:[_,D,N,d,K,V,G,Q,j]})};export{Y as AuthModule};
